/* ========== Limestone Reading — Clean Spec ========== */
:root{
  --ai: #B5B1AB;
  --notes: #F5F2E9;
  --notes-text: #123E2A;
  --topbar: #716868;
  --page: #D9D6CD;
  --scroll: #9A9792;
  --text: #463F3F;
  --accent: #00361D;
}

/* Base */
*,
*::before,
*::after{ box-sizing:border-box; }
html, body{ height:100%; }
body{
  margin:0;
  font-family:"Times New Roman", Tinos, serif;
  color:var(--text);
  background:var(--page);
}

/* Exit button — always top-left, independent of header width */
.exit-btn-fixed{
  position:fixed;
  z-index:1001;
  top:8px; left:8px;
  width:36px; height:36px;
  display:inline-flex; align-items:center; justify-content:center;
  border-radius:50%;
  background:rgba(0,0,0,.08);
  box-shadow:inset 0 0 0 1px rgba(255,255,255,.12);
}
.exit-btn-fixed img{ width:24px; height:24px; display:block; }

.ai-form img{ width:22px; height:22px; display:block; }

.pdf-scroll::-webkit-scrollbar{ width:10px; }
.pdf-scroll::-webkit-scrollbar-thumb{ background:var(--scroll); border-radius:6px; }

/* Rendered pages container (children styled inline in JS) */
.pdf-pages{ width:100%; }

/* Progress bar */
.progress-bar{
  margin:10px auto 0;
  display:flex; gap:10px; align-items:center; justify-content:center;
}
.progress-bar input{
  width:90px; padding:6px 8px;
  border-radius:6px; border:1px solid rgba(0,0,0,.15);
}
.btn-save{
  padding:8px 12px; border-radius:8px;
  border:1px solid rgba(0,0,0,.15); background:#fff; cursor:pointer;
}

.notes.expanded{ grid-column: 2 / span 2; } /* when no file, occupy middle+right */
.notes-head{ font-weight:700; margin-bottom:8px; }
.note-form{ display:flex; flex-direction:column; gap:8px; }
.note-form .row{ display:flex; gap:8px; }
.note-form input, .note-form textarea{
  width:100%; padding:8px 10px;
  border:1px solid #d0c8bc; border-radius:6px; background:#fff; outline:none; color:var(--notes-text);
}
.note-form .actions{ display:flex; justify-content:flex-end; }
.btn.primary{
  background:var(--accent); color:#fff; border:1px solid var(--accent);
  border-radius:8px; padding:8px 12px; cursor:pointer;
}

.note-list{ margin-top:8px; overflow:auto; flex:1; display:flex; flex-direction:column; gap:8px; }
.note{
  background:#fff; border:1px solid #e3dccf; border-radius:8px; padding:10px; color:#2b3a31;
}
.note header{ display:flex; align-items:center; gap:8px; }
.note .ttl{ font-weight:700; }
.note .pg{ margin-left:auto; font-size:12px; color:#6a7a70; }
.note .link.danger{ background:transparent; border:0; color:#9b2c2c; cursor:pointer; }
.note .txt{ margin-top:6px; white-space:pre-wrap; }
.note .ts{ margin-top:6px; font-size:12px; color:#7a7a7a; }

/* Page HUD bubble */
.page-hud{
  position:fixed; left:50%; bottom:18px; transform:translateX(-50%);
  padding:6px 10px; border-radius:8px; background:rgba(0,0,0,.6); color:#fff;
  font-family:"Times New Roman", Tinos, serif; font-size:14px; line-height:1; z-index:1000; pointer-events:none;
}

/* --- FRAME: make the whole screen a 3-column, 2-row grid --- */
.reader-shell{
  min-height: 100vh;
  display: grid;
  grid-template-columns: 1fr 2fr 1fr; /* 1/4 | 2/4 | 1/4 */
  grid-template-rows: 54px 1fr;      /* topbar | content */
  gap: 0;                             /* no gutters so panes touch edges */
}

/* Only the middle column gets the dark top bar, flush with the top */
.topbar{
  grid-column: 2;
  grid-row: 1;
  height: 54px;
  background: var(--topbar);
  color: #fff;
  display: grid;
  grid-template-columns: 1fr minmax(720px, 1000px) 1fr; /* centered lane */
  align-items: center;
  margin: 0;           /* attach to very top */
  border-radius: 0;
}
.topbar .bar-inner{
  grid-column: 2;
  display: flex;
  align-items: center;
  gap: 12px;
}
.topbar .book-title{ font-weight:700; }
.topbar .spacer{ flex:1; }

/* Let children of .layout be grid items of .reader-shell */
.layout{ display: contents; }

/* Left pane: solid B5B1AB, spans top-to-bottom (rows 1..2) */
.askai{
  grid-column: 1;
  grid-row: 1 / span 2;
  background: #B5B1AB;
  border-radius: 0;
  padding: 12px;
  display: flex;
  flex-direction: column;
  min-height: 0;
}
.askai-head{ font-weight:700; margin-bottom:8px; color:#0F3524; }

/* Response area (top, padded F5F2E9) and tiny ask row at bottom */
.ai-out{
  flex: 1;
  background: #F5F2E9;
  border-radius: 8px;
  padding: 12px 14px;
  margin-top: 6px;
  overflow: auto;
  display: flex;
  align-items: center;
  justify-content: center;
  text-align: left;
  color: var(--text);
}
.ai-form{
  display: flex;
  gap: 8px;
  margin-top: 10px;
}
.ai-form input{
  flex: 1;
  padding: 8px 10px;
  border: 1px solid #cfc6b8;
  border-radius: 6px;
  outline: none;
  background: #EEE9E0;
  color: #0F3524;
}
.ai-form input::placeholder{ color:#0F3524; opacity:.7; }
.ai-form .icon-btn{
  width: 38px; height: 38px; border: 0; background: transparent;
  display:inline-flex; align-items:center; justify-content:center; cursor:pointer;
}

/* Middle reader column lives under the topbar (row 2) */
.book-area{
  grid-column: 2;
  grid-row: 2;
  background: transparent;
  display: flex;
  flex-direction: column;
  min-width: 0;
}

/* Right pane: solid F5F2E9, spans top-to-bottom (rows 1..2) */
.notes{
  grid-column: 3;
  grid-row: 1 / span 2;
  background: #F5F2E9;
  color: var(--notes-text);
  border-radius: 0;
  padding: 10px;
  display: flex;
  flex-direction: column;
  min-width: 0;
}

/* Reader scroll height stays correct with the fixed topbar */
.pdf-scroll{
  flex: 1;
  min-height: 60vh;
  max-height: calc(100vh - 54px - 90px); /* topbar + progress bar */
  overflow: auto;
  padding: 12px 0;
}